import re

from ib_users.constants.model_validators import OTP_MAX_LENGTH
from ib_users.exceptions.otp_verification_exceptions import \
    InvalidOTPException, ExceptionMessage


def validate_otp(otp: str):
    stripped_otp = otp.strip()
    if stripped_otp == "":
        raise InvalidOTPException(message=ExceptionMessage.OTP_IS_EMPTY)
    elif len(stripped_otp) != OTP_MAX_LENGTH:
        raise InvalidOTPException(message=ExceptionMessage.OTP_SHOULD_CONTAIN_X_DIGITS)
    elif not stripped_otp.isdigit():
        raise InvalidOTPException(message=ExceptionMessage.\
                                  OTP_SHOULD_CONTAIN_ONLY_NUMBERS)
