from .base_validator import BaseValidator
from django.core.validators import ValidationError


class DOBValidator(BaseValidator):

    @classmethod
    def validate(cls, value):
        from ib_users.exceptions.invalid_dob_exception import \
            InvalidDOBException
        try:
            cls._validate_dob(value)
        except ValidationError as e:
            raise InvalidDOBException(e.message, e.code)

    @classmethod
    def _validate_dob(cls, dob):
        from datetime import datetime
        try:
            datetime.strptime(dob, '%Y-%m-%d')
        except ValueError:
            from ib_users.constants.custom_exception_messages import \
                INVALID_DOB
            raise ValidationError(message=INVALID_DOB.message,
                                  code=INVALID_DOB.code)
