from dataclasses import dataclass

from ib_users.constants.user_account_constants import UserAccountConstants


@dataclass
class ExceptionMessageDTO:
    message: str
    code: str


USERNAME_CAN_NOT_BE_EMPTY = ExceptionMessageDTO(
    "Username can't be empty",
    "USERNAME_CAN_NOT_BE_EMPTY"
)

USER_MAX_NAME_LENGTH_IS = ExceptionMessageDTO(
    "Max username length is {val} characters".format(
        val=UserAccountConstants.MAX_USER_NAME_LENGTH),
    "MAX_USER_NAME_LENGTH_IS"
)

USER_NAME_SPECIAL_CHARACTERS = ExceptionMessageDTO(
    "Username with special characters other than @/./+/-/_ are not allowed",
    "USER_NAME_SPECIAL_CHARACTERS"
)

PASSWORD_MIN_LENGTH_IS = ExceptionMessageDTO(
    "Min password length is {val} characters".format(
        val=UserAccountConstants.MIN_PASSWORD_LENGTH),
    "PASSWORD_MIN_LENGTH_IS"
)

PASSWORD_AT_LEAST_1_SPECIAL_CHARACTER = ExceptionMessageDTO(
    "Password must contain at least 1 non-alphanumeric character",
    "PASSWORD_AT_LEAST_1_SPECIAL_CHARACTER"
)

NOT_REGISTERED_USER = ExceptionMessageDTO(
    "User is not registered",
    "NOT_REGISTERED_USER"
)

INCORRECT_PASSWORD = ExceptionMessageDTO(
    "Given password is incorrect",
    "INCORRECT_PASSWORD"
)

INVALID_EMAIL = ExceptionMessageDTO(
    "Enter valid email address",
    "INVALID_EMAIL"
)

INVALID_PHONE_NUMBER = ExceptionMessageDTO(
    "Enter valid phone number",
    "INVALID_PHONE_NUMBER"
)

INVALID_FB_ACCESS_TOKEN = ExceptionMessageDTO(
    "Enter valid fb credentials",
    "INVALID_FB_ACCESS_TOKEN"
)

FB_NOT_LINKED = ExceptionMessageDTO(
    "Facebook account is not linked",
    "FB_NOT_LINKED"
)

INVALID_GOOGLE_ACCESS_TOKEN = ExceptionMessageDTO(
    "Enter valid google credentials",
    "INVALID_GOOGLE_ACCESS_TOKEN"
)

GOOGLE_NOT_LINKED = ExceptionMessageDTO(
    "Google account is not linked",
    "GOOGLE_NOT_LINKED"
)

INVALID_TWITTER_ACCESS_TOKEN = ExceptionMessageDTO(
    "Enter valid twitter credentials",
    "INVALID_TWITTER_ACCESS_TOKEN"
)

TWITTER_NOT_LINKED = ExceptionMessageDTO(
    "Twitter account is not linked",
    "TWITTER_NOT_LINKED"
)

INVALID_OTP = ExceptionMessageDTO(
    "Invalid OTP",
    "INVALID_OTP"
)

INVALID_REFRESH_TOKEN = ExceptionMessageDTO(
    "Invalid refresh token",
    "INVALID_REFRESH_TOKEN"
)

EXPIRED_REFRESH_TOKEN = ExceptionMessageDTO(
    "Refresh token is expired",
    "EXPIRED_REFRESH_TOKEN"
)

USER_NOT_MAPPED_TO_DEVICE = ExceptionMessageDTO(
    "No profile matching requested user id",
    'USER_NOT_MAPPED_TO_DEVICE'
)

ACCESS_TOKEN_NOT_MAPPED_TO_DEVICE = ExceptionMessageDTO(
    "Given access token and device id do not map",
    'ACCESS_TOKEN_NOT_MAPPED_TO_DEVICE'
)

DEVICE_ID_CANNOT_BE_EMPTY = ExceptionMessageDTO(
    "Device id cannot be empty",
    'DEVICE_ID_CANNOT_BE_EMPTY'
)

DEVICE_ID_DOES_NOT_EXIST = ExceptionMessageDTO(
    "Device id does not exist",
    'DEVICE_ID_DOES_NOT_EXIST'
)

USER_ACCOUNT_IS_DEACTIVATED = ExceptionMessageDTO(
    "User Account is deactivated",
    "USER_ACCOUNT_IS_DEACTIVATED"
)

INVALID_SOCIAL_PROVIDER_TYPE = ExceptionMessageDTO(
    "Invalid social account provider",
    "INVALID_SOCIAL_PROVIDER_TYPE"
)

INVALID_LOGIN_TYPE = ExceptionMessageDTO(
    "Invalid login type",
    "INVALID_LOGIN_TYPE"
)

REFRESH_TOKEN_NOT_FOUND = ExceptionMessageDTO(
    "Refresh Token Not Found",
    "REFRESH_TOKEN_NOT_FOUND"
)

ACCESS_TOKEN_NOT_FOUND = ExceptionMessageDTO(
    "Access Token Not Found",
    "ACCESS_TOKEN_NOT_FOUND"
)

REFRESH_TOKEN_EXPIRED = ExceptionMessageDTO(
    "Refresh Token Expired",
    "REFRESH_TOKEN_EXPIRED"
)

OTP_NOT_REQUESTED = ExceptionMessageDTO(
    "OTP not requested",
    "OTP_NOT_REQUESTED"
)

USER_NEW_PHONE_DETAILS_IS_SAME_AS_EXISTING_PHONE_DETAILS = \
    ExceptionMessageDTO(
        'Given phone number is same as existing phone number',
        'USER_NEW_PHONE_DETAILS_IS_SAME_AS_EXISTING_PHONE_DETAILS'
    )


UPDATE_USER_PHONE_NUMBER_INTERVAL_NOT_COMPLETED = \
    ExceptionMessageDTO(
        'You have updated your mobile number on {}, '
        "you can't update until {}",
        'UPDATE_USER_PHONE_NUMBER_INTERVAL_NOT_COMPLETED'
    )


USER_UPDATE_PHONE_NUMBER_LOG_DETAILS_DOES_NOT_EXIST = ExceptionMessageDTO(
    "User new phone details does not exist.",
    "USER_UPDATE_PHONE_NUMBER_LOG_DETAILS_DOES_NOT_EXIST"
)


USER_PHONE_NUMBER_UPDATED_ALREADY = ExceptionMessageDTO(
    "You have already updated your phone number",
    "USER_PHONE_NUMBER_UPDATED_ALREADY"
)


INVALID_REQUEST_ID = ExceptionMessageDTO(
    "Given request id is invalid.",
    "INVALID_REQUEST_ID"
)


INVALID_FINGERPRINT_JS_WEBHOOK_CREDENTIALS = ExceptionMessageDTO(
    "Invalid fingerprint js webhook credentials",
    "INVALID_FINGERPRINT_JS_WEBHOOK_CREDENTIALS"
)


INVALID_FINGERPRINT_JS_WEBHOOK_REQUEST_BODY = ExceptionMessageDTO(
    "Invalid fingerprint js webhook request body.",
    "INVALID_FINGERPRINT_JS_WEBHOOK_REQUEST_BODY"
)


USER_NEW_EMAIL_IS_SAME_AS_EXISTING_EMAIL = ExceptionMessageDTO(
    'Given email is same as existing email',
    'USER_NEW_EMAIL_IS_SAME_AS_EXISTING_EMAIL'
)


CLIENT_NOT_FOUND = ExceptionMessageDTO(
    "Client Not Found",
    "CLIENT_NOT_FOUND"
)


class ExceptionMessages:
    USERNAME_ALREADY_EXISTS = "Username already exists"
    USERNAME_DOES_NOT_EXIST = "Given username does not exist"
    USER_DOES_NOT_EXIST = "User does not exist"
    GIVEN_USERNAME_IS_SAME = "Given username is same as current username"
    USER_ACCOUNT_IS_ALREADY_ACTIVE = "User account is already active"
    SOCIAL_ACCESS_TOKEN_IS_EMPTY = "{0}" + "access token is empty"
    SOCIAL_ACCOUNT_ALREADY_TAKEN = "Social account already taken by other"
    USER_ACCOUNT_IS_ALREADY_DEACTIVATED = 'User account is already deactivated'
    NO_SOCIAL_ACCOUNT_AVAILABLE = '{0}' + ' Account is not Linked'
    MAXIMUM_REFERRAL_LIMIT_REACHED = \
        "Maximum referral limit of referral code is reached"
    CANT_LINK_TO_OWN_REFERRAL_CODE = "Can't link to own referral code"
    INVALID_REFFERAL_CODE = "Referral code is invalid"
    REFERRAL_DETAILS_DOES_NOT_EXIST = "Referral details does not exist"
    REFERRER_DETAILS_DOES_NOT_EXIST = "Referrer details does not exist"
    USER_ALREADY_LINKED_WITH_ANOTHER_REFERRER = \
        "User already linked with another referrer"


class ExceptionConstants:
    USERNAME_ALREADY_EXISTS_EXCEPTION = "Account already exists with " \
                                        "this username"
    ACCOUNT_ALREADY_EXISTS_WITH_THIS_EMAIL = "Account already exists with " \
                                             "this email id"
    ACCOUNT_ALREADY_EXISTS_WITH_THIS_PHONE_NUMBER = "Account already exists " \
                                                    "with this Phone number"
    ACCOUNT_ALREADY_EXISTS_WITH_THIS_FB_DETAILS = "Account already exists " \
                                                  "with this Facebook " \
                                                  "Account"
    ACCOUNT_ALREADY_EXISTS_WITH_THIS_TWITTER_DETAILS = "Account already " \
                                                       "exists with this " \
                                                       "Twitter Account"
    ACCOUNT_ALREADY_EXISTS_WITH_THIS_GOOGLE_DETAILS = "Account already " \
                                                      "exists with this " \
                                                      "Google Account"

    INVALID_PHONE_NUMBER = "Invalid Phone Number"
    INVALID_EMAIL = "Invalid Email"
    INVALID_FB_DETAILS = "Invalid Facebook Details"
    INVALID_TWITTER_DETAILS = "Invalid Twitter Details"
    INVALID_GOOGLE_DETAILS = "Invalid Google Details"
    INVALID_VERIFICATION_STATUS = 'Invalid verification status {}'
