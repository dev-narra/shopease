import datetime

from ib_users.interactors.third_party.user_tokens_generator import UserAuthTokensDTO
from ib_users.presenters import UserLoginJSONPresenter


def test_get_user_login_response():
    user_tokens_dto = UserAuthTokensDTO("user_id",
                                        "dummy access token",
                                        "dummy refresh token",
                                        datetime.datetime.now())

    expected_user_login_response_json = dict(
        user_id=user_tokens_dto.user_id,
        access_token=user_tokens_dto.access_token,
        refresh_token=user_tokens_dto.refresh_token,
        expires_in=user_tokens_dto.expires_in)

    user_login_json_presenter = UserLoginJSONPresenter()
    json_response = user_login_json_presenter.get_user_login_response(
        user_tokens_dto)

    assert json_response == expected_user_login_response_json
